\newpage
\section{Udprintsfunktionalitet\label{udprint}}

\subsection{Indledende overvejelser}

Ud fra kravet fra EIK Bank om at systemet skal kunne printe en pæn rapport ud til kunden, har vi undersøgt hvilke muligheder vi har for at løse denne opgave. Vi var alle i gruppen uerfarne med det at konstruere print-funktionalitet, hvorfor en del research af området var nødvendig.

Vi lagde fokus på udprint-funktionaliteten i de sidste to uger af den tid vi havde til at udvikle systemet i. Det første vi gjorde var at undersøge muligheden for selv at konstruere en udprint-konstruktion, via de print-libraries der ligger i Visual Studio. Vi fandt dog hurtigt ud af at denne konstruktion ville blive temmelig kompliceret og kræve rigtig meget tid at lave. Kodeomfanget ville blive voldsomt og det at researche og finde ud af hvordan det kunne gøres, ville blive meget omfangsrigt. Vi konstruerede, til formålet, en helt simpel test-applikation, hvor vi printede en variabel fra datastrukturen ud. Dette virkede fint, men der er lang vej fra en simpel variabel til en konstruktionen af en færdig rapport.

Da vi ikke følte at dette var den rigtige løsning, begyndte vi at se på alternative muligheder. Vi undersøgte om der allerede findes værktøjer skabt til at løse problemet. Til det formål fandt vi, via hjælp fra en lærer på Niels Brock, værktøjet Crystal Reports. Crystal Reports er et komponentbaseret rapporteringsværktøj til .Net, med andre ord en udskriftsgenerator der kan lave formularer med datafelter fra databasen eller fra datastrukturen. Med dette værktøj kan man konstruere og designe en rapport ud fra de data man har i sin applikation, hvor den resulterende rapport minder meget om et pdf-dokument. Der er inkluderet udprint-funktionalitet i værkøtjet, hvormed printproblematikken er løst for vores vedkommende, da man kan printe rapporten ud, ved et simpelt tryk på en knap. Hermed kan programmet også levere en digital udgave af rapporten på skærmen, før man printer, hvilket var et ønske fra EIK Banks side.

Crystal Reports viste sig rent faktisk at være inkluderet i Visual Studio 2005, det udviklingsmiljø som vi har brugt til udviklingen af applikationen. Så til formålet, syntes Crystal Reports at være den perfekte løsning. Både i henhold til vores problem med selve funktionaliteten, men også i forhold til EIK Banks behov.


\subsection{Værktøjet Crystal Reports}

Crystal rapporten bliver genereret runtime, det vil sige når programmet kører og brugeren på et tidspunkt beder om at få rapporten lavet. 

Rapporten tilføjes til programmet som en komponent, hvor man kan definere hvilken datakilde komponenten skal have. Vi er ikke interesserede i at have databasen som datakilde, da vi allerede har trukket data ind i datastrukturen fra databasen én gang. Dermed er det for os nærliggende at lade rapporten få sine data direkte fra datastrukturen, også da det formentlig vil være hurtigere at tilgå datastrukturen end at tilgå databasen. Til dette formål oprettes et dataset, hvor de for rapporten, relevante data placeres. Rapporten får det oprettede dataset som datakilde og har dermed adgang til de data den skal bruge. Disse data omfatter kundens personlige data og økonomiske forhold.

Designet af rapporten kan foregå via den wizard som opretter rapporten, eller via et 'træk og slip' designview hvor man manuelt kan styre komponenterne i rapporten. 

Designet af selve rapporten baserede vi på et tidligere udarbejdet layout, hvor kunderne i en session var stillet op ved siden af hinanden i kolonnner og hvor de økonomiske forhold var listet i rækker. Vi lavede dette udkast i en almindelig teksteditor, ud fra et udkast som EIK Bank selv fremstillede tidligt i projektforløbet. Derefter fremlagde vi det for EIK Bank til en fredagsbriefing, for at få deres mening om layoutet og for at vise dem hvad vi havde forestillet os i forbindelse med rapporten. EIK Bank udtrykte tilfredshed med layoutet og vi havde dermed et udgangspunkt til layoutet af rapporten som begge parter var enige om.

\subsection{Vores erfaring med Crystal Reports}

Vores arbejde med Crystal Reports viste sig dog desværre at skulle blive en del mere tungt og problemfyldt end vi havde regnet med. Det var et stort problem for os at få værktøjet til at gøre hvad vi gerne ville have det til at gøre. Vi manglede simpelthen erfaring med et værktøj, som ingen af os på forhånd kendte til. Vi førte mail-korrespence med en lærer fra skolen der har forstand på området og havde endda et møde med denne lærer. Denne hjælp fik os i gang, men det rakte desværre ikke til en fuld forståelse for værktøjets virke. Vi søgte desuden hjælp på online communitites, men det lykkedes ikke at få brudt problemet med at formatere rapporten løst.

Mere specifikt lå problemet blandt andet i at få crystal til at vise kunderne kolonnevis. Vi kunne ikke få værktøjet til at skrive andet end på rækkevis. Efter en del kæmpen med dette, valgte vi i stedet at forsøge os med at lave én rapport per kunde i sessionen. Dette lykkedes til dels, vi fik programmet til at generere en rapport per kunde, alt efter hvor mange kunder der er i en session. Der var stadig problemer med den rapport som kom ud som resultat af dette. Det lykkedes os ikke at få værktøjet til at vise sumbeløb for hver af kunderne. Vi kunne ikke få Crystal til at skrive summer af en tabel ud, uden også at skrive hver tupel i tabellen ud, hvilket ikke var hensigten.

Vi fik altså værktøjet til at hente relevant data ud af datasættet, men kunne ikke få denne data formateret og sorteret. Derfor endte vi ikke med det tilsigtede resultat.




